name: 🧻 Rulička bot [🚽➕]
on:
  workflow_dispatch:
    inputs:
      filename:
        description: '<filename>.json'
        required: true
        default: '1665762044825'
      content:
        description: 'the json file content'
        required: true
        default: '{"latitude":"50.044601","longtitude":"15.822726","placeName":"U pípy","isClean":false,"hasPaper":false,"canLock":true,"hasWater":false,"isFree":true,"bonusCategory":[],"comment":"","nickName":"","timeStamp":"2022-10-14T15:40:44.825Z"}'
      title:
        description: 'Pub or restaurant title'
        required: true
        default: 'Pod Pařezem'

jobs:
  create_json:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - run: |
        cd _toilets
        echo '${{ github.event.inputs.content }}' > ${{ github.event.inputs.filename }}.json
        cat ${{ github.event.inputs.filename }}.json
        
    - uses: peter-evans/create-pull-request@v4
      with:
        token: ${{ secrets.PAT }}
        commit-message: Add ${{ github.event.inputs.filename }}.json toilet 
        committer: Rulicka [Bot] <rulicka@deniksracu.cz>
        author: Rulica <rulicka@deniksracu.cz>
        signoff: false
        branch: new-toilet-${{ github.event.inputs.filename }}
        delete-branch: true
        title: 'New Toilet request:  ${{ github.event.inputs.title }}'
        body: |
          New toilet 
          - name: ${{ github.event.inputs.title }}
          - filename: ${{ github.event.inputs.filename }}.json

        labels: |
          toilet
        reviewers: petrkucerak
        draft: false
